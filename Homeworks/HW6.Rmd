---
title: "Homework 6"
author: "Francis Olakangil"
date: "2023-11-14"
output: html_document
editor_options: 
  chunk_output_type: console
---

You are playing Dungeons and Dragons. You are an Elf named Steve and you come up against a Orc named Mobrukk Pride Bruiser. You must battle. In order to defeat the Mobrukk you must do the following:

(a) Roll a 6 sided die and call this number n.
(b) You now get n 20 sided dice and you roll all of them.

You defeat the Mobrukk if ANY of the n 20 sided die display a prime number. What is the probability that you defeat Mobrukk? (Run a large number of simulations.)

```{r}
library(tidyverse)

#checking if certain value is prime
prime_check <- function(x) {
  if (x <= 1) {return(FALSE)}
  else if (x == 2) {return(TRUE)}
  #2 and 1 are base exception cases that allow for-statement to work
  for (i in 2:sqrt(x)) {
  #iterating through all possible values x to sqrt bc sqrt guarantees divisor larger than sqrt value as well
    if (x %% i == 0) return(FALSE)
    #using modulo to verify divisibility, return false because isn't prime
  }
  return(TRUE)
}

#simulates battle parameters with dice rolls and prime check
battle_sim <- function() {
  #6-sided die, 1 die with 1 to 6 as options
  n <- sample(1:6, 1, replace = TRUE)
  
  #20-sided die, n=number returned in previous die as number of these dice being rolled
  prime_dice <- sample(1:20, n, replace = TRUE)
  
  #checks each (n) dice roll if prime
  prime_mobrukk_defeat <- any(map_dbl(prime_dice, prime_check)==1)
  #traverses results of 20-sided dice rolls and uses sapply for returning in vector form
  
  return(prime_mobrukk_defeat)
}

sim_num <- 125000

#runs dice rolls 50000 times
results <- map_dbl(1:sim_num, ~battle_sim())

#takes mean of prime dice rolls to find prob. of winning
prob_victory <- mean(results)

cat("After all the dice rolls and prime-number checks, the probability of defeating Mobrukk Pride Bruiser is", prob_victory)
#getting different results after subsequent runs because dice rolls are random

```
