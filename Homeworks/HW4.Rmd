---
title: "Homework 4"
author: "Francis Olakangil"
date: "2023-10-12"
output: html_document
editor_options: 
chunk_output_type: console
---

1. Using the `Teams` data frame in the Lahman package:

a) (10 points) Make a line plot of total home runs per season and stratify by league. Do you see anything interesting that you observe throughout the years? Create the same plot with changing years axis.
```{r}
library("Lahman")
library("tidyverse")
library("ggplot2")


  Teams_plot <- Teams %>% 
    select(yearID, lgID, HR) %>% 
    group_by(yearID, lgID) %>% 
    summarize(
      total_HR = sum(HR)
      
    )
      Teams_plot
      ggplot(data = Teams_plot, aes(x=yearID, y=total_HR, color=lgID)) +geom_line()
  
```
b) (10 points) Create an indicator variable called "winning record" which is defined as TRUE if the number of wins is greater than the number of losses and FALSE otherwise. Plot a scatter plot of Runs (R) vs Runs against (RA) with the color of each point showing whether that team had a winning record or not.
```{r}
TeamsPlotb <- Teams %>% 
  mutate(winningRecord = W/L > 1)

ggplot(data = TeamsPlotb, aes(x=R, y=RA, color = winningRecord)) + geom_point()

```

c) (5 points) Create a scatterplot of strikeouts (SO) vs walks (BB) faceting by Rank 1-5. What do you see?
```{r}
TeamsPlotC <- Teams %>% 
  filter(Rank<=5)
g<- ggplot(data = TeamsPlotC, aes(y=50, x= BB))
g+geom_point()+
facet_wrap(~Rank)
#5 diff ranks, positive correl.
```

d) (10 points) Create a categorical variable with 4 levels: before 1900, 1900-1949, 1950-1999, 2000 or later. (Hint: There is a function called 'cut' that will help you here.) Use this as the color of the point in the scatterplot of strikeouts vs walks that you created in the previous problem. Now what do you see?
```{r}

Teams_plotd <- Teams %>% 
  mutate(years_binned = cut(yearID, c(0, 1899, 1949, 1999, 2023), labels = c('Before
  1900', '1900-1949', '1950-1999', '2000 or later')))
Teams$yearID
  ggplot(data = Teams_plotd, aes(x=SO, y=BB, color=years_binned)) + geom_point()

```


2. Using the `flights` data frame in the nycflight13 package:

a) (5 points) Create a histogram of the departure delays times (dep_delay) for all flights that had a delay time greater than 0.

```{r}
library(ggplot2)
library(nycflights13)
library(dplyr)
library("tidyverse")

  flights %>% 
    filter(dep_delay>0) %>% 
    ggplot(aes(x=dep_delay)) +
    geom_histogram()
  
```


b) (5 points) Repeat the same histogram, but now facet by month. 
```{r}
flights %>% 
  filter(dep_delay>0) %>% 
  ggplot(aes(x = dep_delay)) +
  geom_histogram() +
  facet_wrap(~month)

```

c) (10 points) Create side-by-side boxplots of delay times for flights with if a flight was scheduled to leave before noon or afternoon (use 1200 for the time) for the top 5 airlines (in terms of number of flights).
```{r}
Flightsdelay <- read_csv("../data/flights.csv")
  top5 <- Flightsdelay %>% 
  group_by(carrier) %>% 
  count() %>% 
  arrange(-n) %>% 
  head(5) %>% 
  pull(carrier)

Flightsdelay %>% 
  filter(carrier %in% top5) %>% 
  mutate(time = ifelse(sched_dep_time > 1200, "afternoon", "beforenoon")) %>% 
  ggplot(aes(x=dep_delay, y = time)) +
  geom_boxplot()

```

3. Using `top_colleges_2022` recreate these images.

a) using the wes anderson pallet "GrandBudapest2".
```{r}
library(ggplot2)
library(wesanderson)
library(dplyr)
library("tidyverse")

top_colleges_2022 <- read_csv("../data/top_colleges_2022.csv")

colors <- wes_palette("GrandBudapest2", n = 2)

ggplot(top_colleges_2022, aes(x=studentFacultyRatio, y = undergradPop, color=collegeType))+
geom_point(alpha=0.6, size = 3)+ labs(title="student ratio versus undergraduate population by 
type of institution",
  x= "student per faculty", y= "undergraduate population")+ 
    scale_color_manual(values = colors)+
    theme_minimal()

```

![](../img/hw4_ex3a.png)

b) Create these two plots and report what stands out from each one.
```{r}
top_colleges_2022 %>% 
  filter(! is.na(region)) %>% 
  ggplot( aes(x=region, fill = campusSetting)) + geom_bar(stat = ("count"),
  position="dodge")

```
![](../img/hw4_ex3b2.png)
